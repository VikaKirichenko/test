Задание 1:

sql таблица данных из csv файла  находится  в файле Orders - Orders.sql

```sql
-- 1 Новые торговые точки 
select EXTRACT(MONTH FROM m1.purchase_date) as month, array_agg(m1.client_id)
from mytable m1
where m1.client_id not in (
    select m2.client_id
    from mytable m2
    where EXTRACT(MONTH FROM m2.purchase_date) < EXTRACT(MONTH FROM m1.purchase_date)
)
group by EXTRACT(MONTH FROM m1.purchase_date);
``` 	
Вывод результата первого запроса: 

5,"{9902,6365,3632,3736,3736,7160,3862,7463,7899,3984,8189,4274,4380,8708,1133,5382}"

6,"{8791,7618,7643,440,913,999,7931,472,235,944,8125,669,1604,5733,400,766,781,205,827,6732,165,6953,1200,963,976,611}"

7,"{5029,5060,5175,5229,5532,5604,5695,5755,5845,6070,6513,6935,6970,7128,7252,7703,7734,7964,8011,8073,8341,8381,8525,8586,8827,9173,9249,9318,9364,9602,9704,9990,250,251,253,527,641,747,886,939,1019,1298,1411,1433,1657,1731,1902,1916,1941,2066,2154,2378,2464,2555,2712,2718,2820,2998,3078,3087,3183,3278,3300,3376,3425,3443,3878,3903,3965,4224,4461,4608,4972}"

8,{5103}

```sql
-- 2  Торговые точки, сделавшие заказ в прошлом месяце и в этом
select EXTRACT(MONTH FROM m1.purchase_date) as month, array_agg(m1.client_id)
from mytable m1
where m1.client_id in (
    select m2.client_id
    from mytable m2
    where EXTRACT(MONTH FROM m2.purchase_date) = EXTRACT(MONTH FROM m1.purchase_date) - 1
)
  and m1.client_id in (
    select m2.client_id
    from mytable m2
    where EXTRACT(MONTH FROM m2.purchase_date) = EXTRACT(MONTH FROM m1.purchase_date)
)
group by EXTRACT(MONTH FROM m1.purchase_date);
```

Вывод результата второго запроса: 

6,"{7703,1411,1433,1604,1657,1731,1902,1916,1941,2378,2464,2555,2712,2718,2820,2998,3078,3087,3183,3278,3300,3376,3425,3443,3878,3903,3965,4224,4461,4608,4972,5029,5060,5175,5229,5532,5695,5733,5755,5845,6070,6732,6935,6953,6970,7128,7252,7618,7643,250,7734,7931,7964,8011,8073,8125,8341,8381,8525,8586,8791,8827,9173,9249,9318,9364,9602,9704,9990,251,253,527,747,886,939,963,1019,1200,1298}"

7,"{250,8341,251,3965,253,7128,527,4224,747,9704,886,4461,939,7252,4608,1019,8381,4972,1298,9249,1411,5029,1433,8525,5060,1657,7703,1731,5175,1902,9602,1916,5229,1941,7734,2378,5532,2464,8586,2555,5695,2712,9318,2718,7964,2820,5755,2998,9990,3078,5845,3087,8011,3183,6070,3278,8827,3300,8073,3376,6935,3425,9364,3443,9173,3878,6970,3903}"

```sql
-- 3  Торговые точки, которые когда-то что-то заказали(только не в прошлом месяце) и вернувшиеся.

select EXTRACT(MONTH FROM m1.purchase_date) as month, array_agg(m1.client_id)
from mytable m1
where m1.client_id in (
    select m2.client_id
    from mytable m2
    where EXTRACT(MONTH FROM m2.purchase_date) < EXTRACT(MONTH FROM m1.purchase_date) - 1
)
  and m1.client_id in (
    select m2.client_id
    from mytable m2
    where EXTRACT(MONTH FROM m2.purchase_date) = EXTRACT(MONTH FROM m1.purchase_date)
)
group by EXTRACT(MONTH FROM m1.purchase_date);
```

Вывод результата Третьего запроса: 

7,"{9990,251,253,527,641,747,886,939,1019,1298,1411,1433,1657,1731,1902,1916,1941,2066,2154,2378,2464,2555,2712,2718,2820,2998,3078,3087,3183,3278,3300,3376,3425,3443,3878,3903,3965,4224,4461,4608,4972,5029,5060,250,5175,5229,5532,5604,5695,5755,5845,6070,6513,6935,6970,7128,7252,7703,7734,7964,8011,8073,8341,8381,8525,8586,8827,9173,9249,9318,9364,9602,9704}"

8,{5103}

```sql
--4  Торговые точки, отвалившиеся в этом месяце. 
select EXTRACT(MONTH FROM m1.purchase_date) as month, array_agg(m1.client_id)
from mytable m1
where m1.client_id not in (
    select m2.client_id
    from mytable m2
    where EXTRACT(MONTH FROM m2.purchase_date) > EXTRACT(MONTH FROM m1.purchase_date)
)
group by EXTRACT(MONTH FROM m1.purchase_date);


```

Вывод результата четвертого запроса: 

5,"{9902,6365,3632,3736,3736,7160,3862,7463,7899,3984,8189,4274,4380,8708,1133,5382}"

6,"{8791,7618,7643,440,913,999,7931,472,235,944,8125,669,1604,5733,400,766,781,205,827,6732,165,6953,1200,963,976,611}"

7,"{5029,5060,5175,5229,5532,5604,5695,5755,5845,6070,6513,6935,6970,7128,7252,7703,7734,7964,8011,8073,8341,8381,8525,8586,8827,9173,9249,9318,9364,9602,9704,9990,250,251,253,527,641,747,886,939,1019,1298,1411,1433,1657,1731,1902,1916,1941,2066,2154,2378,2464,2555,2712,2718,2820,2998,3078,3087,3183,3278,3300,3376,3425,3443,3878,3903,3965,4224,4461,4608,4972}"

8,{5103}



Задание 2:

[ссылка](https://docs.google.com/spreadsheets/d/1N0HRoWTDgbRwBAfdurinDRZjlKQlVYxxzvO_wwhkncA/edit?usp=sharing) на google sheet при парсинге 20 постов группы **[Читай-город](https://vk.com/chitaigorod)**

Также был добавлен столбец "подпись поста"

Код программы находится в файле sheet.gs

При каждом запуске скрипт создает таблицу и заполнет ее информацией о первых 20 постах.